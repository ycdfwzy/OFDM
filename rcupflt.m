function new_signal = rcupflt(raw_signal)
%RC 此处显示有关此函数的摘要
%   此处显示详细说明
% b = rcosdesign(0.5, 4, 10);
% new_signal = upfirdn(raw_signal, b, 10);
    beta = 10;
    Nsym = 4;
    sampsPerSym = 10;
    H = [0.013427674865534088, -0.03356918716383521,...
        0.35960619065433957, -0.03356918716383521, 0.013427674865534088,...
        0.012735903231668802, -0.00851745396358352, 0.35104533721079589,...
        -0.047360864551823735, 0.0, 0.008453156912747329, 0.027708352033020543,...
        0.32617926034852995, -0.051000786326600635, 0.0, 0.00043693057910991815,...
        0.073695928108432215, 0.28735810559134217, -0.046520709600807369, 0.0,...
        -0.010739957583904041, 0.12674306972477839, 0.23818153519927915,...
        -0.03651359231196992, 0.0, -0.023736999882468295, 0.18306897632094107,...
        0.18306897632094107, -0.023736999882468295, 0.0, -0.03651359231196992,...
        0.23818153519927915, 0.12674306972477839, -0.010739957583904041, 0.0,...
        -0.046520709600807369, 0.28735810559134217, 0.073695928108432215,...
        0.00043693057910991815, 0.0, -0.051000786326600635, 0.32617926034852995,...
        0.027708352033020543, 0.008453156912747329, 0.0, -0.047360864551823735,...
        0.35104533721079589, -0.00851745396358352, 0.012735903231668802, 0.0];
    
    N = length(raw_signal);
    new_signal = zeros(N*sampsPerSym, 1);
    
    buff = zeros(5, 1);
    inIdx = 1;
    outIdx = 1;
    inBufIdx = 1;
    for n = 1:N
        buff(inBufIdx) =  raw_signal(inIdx);
        inIdx = inIdx + 1;
        
        k = 0;
        while k < 10
            acc = 0.0;
            offset = k * 5;
            for i = inBufIdx:5
                acc = acc + H(offset + i - inBufIdx + 1) * buff(i);
            end
            for i = 1:inBufIdx-1
                acc = acc + H(offset + i - inBufIdx + 5 + 1) * buff(i);
            end
            new_signal(outIdx) = acc;
            outIdx = outIdx + 1;
            k = k + 1;
        end
        
        if inBufIdx == 1
            inBufIdx = 5;
        else
            inBufIdx = inBufIdx - 1;
        end
    end
end

